<!DOCTYPE html>

<html>



<head>

    <title>ScalarField / ASCIIGrid</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" />
<!--add type="text/html"-->
    <link rel="stylesheet" type="text/html" href="examples.css" />

<!-- the following links add the CSS and Javascript required for the Leaflet Map -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.1.0/dist/leaflet.css"
integrity="sha512-wcw6ts8Anuw10Mzh9Ytw4pylW8+NAD4ch3lqm9lzAsTxg0GFeJgoAtxuCLREZSC5lUXdVyo/7yfsqFjQ4S+aKw=="
crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.1.0/dist/leaflet.js"
integrity="sha512-mNqn2Wg7tSToJhvHcqfzLMU6J4mkOImSPTxVZAdo+lcPlk+GhZmYgACEe0x35K7YzW1zJ7XyJV/TT1MrdXvMcA=="
crossorigin=""></script>
<!-- the following CSS is used to set the size of the Map -->
<style type="text/css">
#map { width: 600px; height: 400px; }
</style>

    <link href="https://fonts.googleapis.com/css?family=Roboto:100,400" rel="stylesheet">

</head>



<body>

    <h1 class="title mapTitle">ScalarField</h1>

    <div id="map"></div>



    <!-- CDN -->

    <script src="https://d3js.org/d3.v4.min.js"></script>

    <script src="https://npmcdn.com/leaflet@1.2.0/dist/leaflet.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.0/chroma.min.js"></script>



    <!-- Plugin -->

    <script src="https://unpkg.com/leaflet-canvaslayer-field/dist/leaflet.canvaslayer.field.js"></script>



    <script>

        let map = L.map('map');



        /* Basemap 

        var url = 'https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png';

        L.tileLayer(url, {

            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/attributions">CARTO</a>',

            subdomains: 'abcd'

        }).addTo(map);
		*/
		// load the tiles
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {maxZoom: 18,
attribution: 'Map data &copy; <ahref="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>,' +
'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
id: 'mapbox.streets'
}).addTo(map);



        /* An ASCIIGrid Raster with Surface current velocity */

        d3.text('ascii.asc', function (asc) {

            let s = L.ScalarField.fromASCIIGrid(asc);

            let layer = L.canvasLayer.scalarField(s).addTo(map);

            map.fitBounds(layer.getBounds());



            layer.on('click', function (e) {

                if (e.value !== null) {

                    let v = e.value.toFixed(0);
					let s = e.value.toFixed(1);
					let r = e.value.toFixed(2);

                    let html = `<span class="popupText">value test ${v},${s},${r} </span>`;

                    let popup = L.popup().setLatLng(e.latlng).setContent(html).openOn(map);

                }

            });



            layer.on('mousemove', function (e) {

                console.log(e.latlng);

            });

        });

    </script>

</body>



</html>